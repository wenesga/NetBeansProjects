PROGRAM EX21;
USES CRT;
TYPE cliente = RECORD
	numero : INTEGER;
	nome : STRING[20];
	END;
clientes = FILE OF cliente;

TYPE conta = RECORD
	numero_conta : INTEGER;
	numero_cli : INTEGER;
	saldo : REAL;
END;
contas = FILE OF conta;
VAR 	con: contas;
	co: conta;
	cli: clientes;
	cl: cliente;
K, I : INTEGER;
ACHOU : BOOLEAN;
NUM_CONTA, NUM_CLIENTE: INTEGER;
SALDO: REAL;
BEGIN
CLRSCR;
ASSIGN(CON, 'C:\CONTAS.DAT');
{$I-}
RESET(CON);
{$I+}
IF IORESULT = 2
   THEN REWRITE(CON);
ASSIGN(CLI, 'C:\CLIENTES.DAT');
{$I-}
RESET(CLI);
{$I+}
IF IORESULT = 2
   THEN REWRITE(CLI);
K := FILESIZE(CON);
WRITE('DIGITE O NÈMERO DA CONTA A SER INCLU÷DA ');
READLN(NUM_CONTA);
WRITE('DIGITE O NÈMERO DO CLIENTE DA CONTA ');
READLN(NUM_CLIENTE);
WRITE('DIGITE O SALDO ');
READLN(SALDO);
ACHOU:=FALSE;
WHILE NOT EOF(CLI) DO
BEGIN
READ(CLI,CL);
IF CL.NUMERO = NUM_CLIENTE
THEN ACHOU:=TRUE;
END;
IF ACHOU = FALSE
THEN WRITELN('ESTE CLIENTE N«O ESTµ CADASTRADO')
ELSE BEGIN
     ACHOU:=FALSE;
IF K = 0
   THEN BEGIN
	CO.NUMERO_CONTA := NUM_CONTA;
	CO.NUMERO_CLI := NUM_CLIENTE;
	CO.SALDO:= SALDO;
	WRITE(CON,CO);
	WRITELN('CONTA INCLU÷DA');
	END
	ELSE BEGIN
	     I := 0;
	     ACHOU := FALSE;
	     WHILE ( I <= (K-1)) DO
		BEGIN
		READ(CON, CO);
		IF CO.NUMERO_CONTA = NUM_CONTA
		   THEN BEGIN
		        ACHOU := TRUE;
			I := K+1;
			END
		   ELSE BEGIN
			I := I+1;
			SEEK(CON, I);
			END;
		END;
	     IF ACHOU = TRUE
		THEN WRITELN('ESTA CONTA Jµ ESTµ CADASTRADA')
		ELSE BEGIN
		     SEEK(CON, K);
		     CO.NUMERO_CONTA := NUM_CONTA;
		     CO.NUMERO_CLI := NUM_CLIENTE;
		     CO.SALDO:= SALDO;
		     WRITE(CON,CO);
                     WRITELN('CONTA INCLU÷DA');
		     END;
	     END;
END;
READLN;
CLOSE(CON);
CLOSE(CLI);
END.
