PROGRAM EX12;
USES CRT;
TYPE vendedor = RECORD
	codigo_vendedor: INTEGER;
	nome_vendedor: STRING[20];
	mes: INTEGER;
	valor_venda: REAL;
	END;
loja = FILE OF vendedor;
VAR L: loja;
         V: vendedor;
         K, I : INTEGER;
        ACHOU : BOOLEAN;
         CODIGO_VENDEDOR, MES: INTEGER;
        NOME_VENDEDOR: STRING[20];
         VALOR_VENDA: REAL;
BEGIN
CLRSCR;
ASSIGN(L, 'C:\VENDAS.DAT');
{$I-}
RESET(L);
{$I+}
IF IORESULT = 2
   THEN REWRITE(L);
K := FILESIZE(L);
WRITE('DIGITE O C‡DIGO DO VENDEDOR A SER INCLU÷DO ');
READLN(CODIGO_VENDEDOR);
WRITE('DIGITE O M“S A SER INCLU÷DO ');
READLN(MES);
IF K = 0
THEN BEGIN
        WRITE('DIGITE O NOME DO VENDEDOR A SER INCLU÷DO ');
        READLN(NOME_VENDEDOR);
        WRITE('DIGITE O VALOR DA VENDA A SER INCLU÷DA ');
        READLN(VALOR_VENDA);
        V.CODIGO_VENDEDOR := CODIGO_VENDEDOR;
	V.MES := MES;
	V.NOME_VENDEDOR := NOME_VENDEDOR;
	V.VALOR_VENDA:= VALOR_VENDA;
	WRITE(L, V);
	WRITELN('VENDEDOR INCLU÷DO');
	END
ELSE BEGIN
	I := 0;
	ACHOU := FALSE;
	WHILE ( I <= (K-1)) DO
	BEGIN
	READ(L, V);
	IF (V.CODIGO_VENDEDOR = CODIGO_VENDEDOR) AND (V.MES  = MES)
	THEN BEGIN
		ACHOU := TRUE;
		I := K+1;
		END
	ELSE BEGIN
		I := I+1;
		SEEK(L,I);
		END;
	END;
	IF ACHOU = TRUE
	THEN WRITELN('ESTE VENDEDOR Jµ ESTµ CADASTRADO ')
	ELSE BEGIN
		SEEK(L, K);
                WRITE('DIGITE O NOME DO VENDEDOR A SER INCLU÷DO ');
                READLN(NOME_VENDEDOR);
                WRITE('DIGITE O VALOR DA VENDA A SER INCLU÷DA ');
                READLN(VALOR_VENDA);
                V.CODIGO_VENDEDOR := CODIGO_VENDEDOR;
		V.MES := MES;
		V.NOME_VENDEDOR := NOME_VENDEDOR;
		V.VALOR_VENDA:= VALOR_VENDA;
		WRITE(L, V);
		WRITELN('VENDEDOR INCLU÷DO');
		END;
END;
READLN;
CLOSE(L);
END.
